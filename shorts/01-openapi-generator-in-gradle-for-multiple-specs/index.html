<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self';style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com;connect-src 'self' *.umami.dev cloud.umami.is;script-src 'self' cloud.umami.is 'self'" http-equiv=Content-Security-Policy><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://tsvldb.com name=base><title>
tsvldb • How to generate sources from multiple OpenAPI specifications with Gradle</title><link title="tsvldb - Atom Feed" href=https://tsvldb.com/atom.xml rel=alternate type=application/atom+xml><link href="https://tsvldb.com/custom_subset.css?h=0b9535a28bc3d5bf2321" rel=stylesheet><link href="https://tsvldb.com/main.css?h=28b3fcbb58f2f22a8c44" rel=stylesheet><meta content="light dark" name=color-scheme><meta content="A Private Low Entropy Broadcast" name=description><meta content="A Private Low Entropy Broadcast" property=og:description><meta content="How to generate sources from multiple OpenAPI specifications with Gradle" property=og:title><meta content=article property=og:type><meta content=en_GB property=og:locale><meta content=https://tsvldb.com/shorts/01-openapi-generator-in-gradle-for-multiple-specs/ property=og:url><meta content=tsvldb property=og:site_name><noscript><link href=https://tsvldb.com/no_js.css rel=stylesheet></noscript><script src=https://tsvldb.com/js/initializeTheme.min.js></script><script defer src=https://tsvldb.com/js/themeSwitcher.min.js></script><script async data-do-not-track=true data-website-id=f0e51e52-1de4-4abe-9cdb-dac6967c3ae0 defer src=https://cloud.umami.is/script.js></script><script src="https://tsvldb.com/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><header><nav class=navbar><div class=nav-title><a class=home-title href=https://tsvldb.com/>tsvldb</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://tsvldb.com/posts/>Posts </a><li><a class="nav-links no-hover-padding" href=https://tsvldb.com/shorts/>Shorts </a><li class=menu-icons-container><ul class=menu-icons-group><li class="js menu-icon"><div aria-label="Click or press $SHORTCUT to open search" class="search-icon interactive-icon" title="Click or press $SHORTCUT to open search" id=search-button role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><li class="theme-switcher-wrapper js"><div aria-label="Toggle dark mode" title="Toggle dark/light mode" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Reset mode to default" class="theme-resetter arrow" title="Reset mode to default" aria-hidden=true role=button tabindex=0></div></ul></ul></div></nav></header><div class=content><main><article class=h-entry><h1 class="p-name article-title">How to generate sources from multiple OpenAPI specifications with Gradle</h1><a class="u-url u-uid" href=https://tsvldb.com/shorts/01-openapi-generator-in-gradle-for-multiple-specs/></a><ul class=meta><span class="hidden p-author h-card"> <a title="Andrii Tsvielodub" class=u-url href=https://tsvldb.com rel=author>Andrii Tsvielodub</a> </span><li><time class=dt-published datetime=2025-04-06>6th Apr 2025</time><li title="805 words"><span aria-hidden=true class=separator>•</span>5 min read</ul><ul class="meta last-updated"><li><time class=dt-updated datetime=2025-04-29>Updated on 29th Apr 2025</time></ul><section class="e-content body"><p>This is a short note on configuring a Java Gradle project that uses the OpenAPI Generator plugin to generate client/server code from multiple specifications, preventing unnecessary code regeneration during project builds.<div class="admonition info"><div class="admonition-icon admonition-icon-info"></div><div class=admonition-content><strong class=admonition-title>Maybe this is fixed already?</strong><p>This is an issue I faced on a project in late 2024, and was reproducible at the time of writing this note, but no guarantees this is still relevant.</div></div><h1 id=problem>Problem</h1><p>On a project that uses Gradle as a build system, there was an issue when all client/server code generated from OpenAPI specs was regenerated for every build. This is expected when doing a full rebuild (a <code>gradle clean build</code> locally or in a CI pipeline), but why would you want that when you are just running your unit tests? This actually makes the process of writing unit tests not very pleasant.<blockquote><p><em>I still don’t know if that projects’ lack of tests was the result of this, or just nobody bothered to fix this issue due to the lack of tests</em> 🤔</blockquote><h1 id=the-cause>The Cause</h1><p>In the existing configuration of the project, each generator task used the same folder as a target – <code>build/generated/openapi</code>. This worked fine for the API code since each spec was built to a different package and didn’t mix. However, besides the code, the plugin also generates a set of project files (like maven pom.xml, etc.).<br> The code didn’t mix due to different packages, but those files did, and each next task was overwriting project files from the previous.<br> Because of that, for every build Gradle considered that the generated code (those project files specifically) did not match what was generated before, and it’s right about time to go generate everything again.<h2 id=example>Example</h2><p>Let’s make a minimal reproduction of the issue first. Here’s the recipe.<ol><li>Take two OpenAPI specs to your liking to generate Server API interfaces.</ol><p><strong>Spec A:</strong><pre class="language-yaml z-code" data-lang=yaml data-name=book-catalog-api.yaml><code class=language-yaml data-lang=yaml data-name=book-catalog-api.yaml><span class="z-source z-yaml"><span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">openapi</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-constant z-numeric z-float z-decimal z-yaml">3<span class="z-punctuation z-separator z-decimal z-yaml">.</span>0.3</span>
</span><span class="z-source z-yaml"><span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">info</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">  <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">title</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">Book Catalog API</span>
</span><span class="z-source z-yaml">  <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">description</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">API for managing book catalog information</span>
</span><span class="z-source z-yaml">  <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">version</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-constant z-numeric z-float z-decimal z-yaml">1<span class="z-punctuation z-separator z-decimal z-yaml">.</span>0.0</span>
</span><span class="z-source z-yaml"><span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">servers</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">  <span class="z-punctuation z-definition z-block z-sequence z-item z-yaml">-</span> <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">url</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">/api/v1</span>
</span><span class="z-source z-yaml"><span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">paths</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">  <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">/books</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">get</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">summary</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">Get all books</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">operationId</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">getAllBooks</span>
</span><span class="z-source z-yaml">      <span class="z-constant z-numeric z-float z-decimal z-yaml"><span class="z-punctuation z-separator z-decimal z-yaml">.</span>..</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">post</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">summary</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">Add a new book</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">operationId</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">addBook</span>
</span><span class="z-source z-yaml">      <span class="z-constant z-numeric z-float z-decimal z-yaml"><span class="z-punctuation z-separator z-decimal z-yaml">.</span>..</span>
</span><span class="z-source z-yaml">  <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">/books/{bookId}</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">get</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">summary</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">Get book by ID</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">operationId</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">getBookById</span>
</span><span class="z-source z-yaml">      <span class="z-constant z-numeric z-float z-decimal z-yaml"><span class="z-punctuation z-separator z-decimal z-yaml">.</span>..</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">put</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">summary</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">Update book</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">operationId</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">updateBook</span>
</span><span class="z-source z-yaml">      <span class="z-constant z-numeric z-float z-decimal z-yaml"><span class="z-punctuation z-separator z-decimal z-yaml">.</span>..</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">delete</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">summary</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">Delete book</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">operationId</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">deleteBook</span>
</span><span class="z-source z-yaml">      <span class="z-constant z-numeric z-float z-decimal z-yaml"><span class="z-punctuation z-separator z-decimal z-yaml">.</span>..</span>
</span><span class="z-source z-yaml"><span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">components</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">  <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">schemas</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">    <span class="z-constant z-numeric z-float z-decimal z-yaml"><span class="z-punctuation z-separator z-decimal z-yaml">.</span>..</span>
</span></code></pre><p><strong>Spec B:</strong><pre class="language-yaml z-code" data-lang=yaml data-name=book-inventory-api.yaml><code class=language-yaml data-lang=yaml data-name=book-inventory-api.yaml><span class="z-source z-yaml"><span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">openapi</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-constant z-numeric z-float z-decimal z-yaml">3<span class="z-punctuation z-separator z-decimal z-yaml">.</span>0.3</span>
</span><span class="z-source z-yaml"><span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">info</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">  <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">title</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">Book Inventory API</span>
</span><span class="z-source z-yaml">  <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">description</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">API for managing book inventory and stock</span>
</span><span class="z-source z-yaml">  <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">version</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-constant z-numeric z-float z-decimal z-yaml">1<span class="z-punctuation z-separator z-decimal z-yaml">.</span>0.0</span>
</span><span class="z-source z-yaml"><span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">servers</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">  <span class="z-punctuation z-definition z-block z-sequence z-item z-yaml">-</span> <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">url</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">/api/v1</span>
</span><span class="z-source z-yaml"><span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">paths</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">  <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">/inventory</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">get</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">summary</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">Get inventory status for all books</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">operationId</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">getInventory</span>
</span><span class="z-source z-yaml">      <span class="z-constant z-numeric z-float z-decimal z-yaml"><span class="z-punctuation z-separator z-decimal z-yaml">.</span>..</span>
</span><span class="z-source z-yaml">  <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">/inventory/{bookId}</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">get</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">summary</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">Get inventory status for a specific book</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">operationId</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">getInventoryItem</span>
</span><span class="z-source z-yaml">      <span class="z-constant z-numeric z-float z-decimal z-yaml"><span class="z-punctuation z-separator z-decimal z-yaml">.</span>..</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">put</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">summary</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">Update inventory for a book</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">operationId</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">updateInventory</span>
</span><span class="z-source z-yaml">      <span class="z-constant z-numeric z-float z-decimal z-yaml"><span class="z-punctuation z-separator z-decimal z-yaml">.</span>..</span>
</span><span class="z-source z-yaml">  <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">/inventory/{bookId}/stock</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">post</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">summary</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">Add stock for a book</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">operationId</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">addStock</span>
</span><span class="z-source z-yaml">      <span class="z-constant z-numeric z-float z-decimal z-yaml"><span class="z-punctuation z-separator z-decimal z-yaml">.</span>..</span>
</span><span class="z-source z-yaml">  <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">/inventory/{bookId}/checkout</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">post</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">summary</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">Checkout a book (reduce stock)</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">operationId</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">checkoutBook</span>
</span><span class="z-source z-yaml">      <span class="z-constant z-numeric z-float z-decimal z-yaml"><span class="z-punctuation z-separator z-decimal z-yaml">.</span>..</span>
</span><span class="z-source z-yaml"><span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">components</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">  <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">schemas</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">    <span class="z-constant z-numeric z-float z-decimal z-yaml"><span class="z-punctuation z-separator z-decimal z-yaml">.</span>..</span>
</span></code></pre><ol start=2><li>Season them with a simple Gradle build</ol><p><strong>Build Config:</strong><pre class="language-gradle z-code" data-lang=gradle><code class=language-gradle data-lang=gradle><span class="z-source z-groovy"><span class="z-meta z-import z-groovy"><span class="z-keyword z-other z-import z-groovy">import</span> <span class="z-storage z-type z-import z-groovy">org.openapitools.generator.gradle.plugin.tasks.GenerateTask
</span></span></span><span class="z-source z-groovy">
</span><span class="z-source z-groovy">plugins <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    id <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>java<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    id <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>org.springframework.boot<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span> version <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>3.4.5<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    id <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>io.spring.dependency-management<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span> version <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>1.1.7<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    id <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>org.openapi.generator<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span> version <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>7.12.0<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span><span class="z-source z-groovy">
</span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> ... generic java project configuration ...
</span></span><span class="z-source z-groovy">
</span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Generate server stubs for book catalog API
</span></span><span class="z-source z-groovy">tasks<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">register</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>catalogApi<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-storage z-type z-class z-groovy">GenerateTask</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    generatorName <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>spring<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    inputSpec <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-variable z-other z-interpolated z-groovy">$rootDir</span>/src/main/resources/api/book-catalog-api.yaml<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    outputDir <span class="z-keyword z-operator z-assignment z-groovy">=</span> layout<span class="z-punctuation z-accessor z-dot z-groovy">.</span>buildDirectory<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">dir</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>generated/openapi<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">get</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span>asFile<span class="z-punctuation z-accessor z-dot z-groovy">.</span>path
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    apiPackage <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>com.example.bookmgmt.api.catalog<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    modelPackage <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>com.example.bookmgmt.model.catalog<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    configOptions <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-structure z-groovy">            <span class="z-constant z-other z-key z-groovy">delegatePattern</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>true<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-structure z-groovy">            <span class="z-constant z-other z-key z-groovy">interfaceOnly</span>  <span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>true<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-structure z-groovy">            <span class="z-constant z-other z-key z-groovy">useSpringBoot3</span> <span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>true<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-structure z-groovy">            <span class="z-constant z-other z-key z-groovy">useTags</span>        <span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>true<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-structure z-groovy">    <span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span><span class="z-source z-groovy">
</span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Generate server stubs for book inventory API
</span></span><span class="z-source z-groovy">tasks<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">register</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>inventoryApi<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-storage z-type z-class z-groovy">GenerateTask</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    generatorName <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>spring<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    inputSpec <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-variable z-other z-interpolated z-groovy">$rootDir</span>/src/main/resources/api/book-inventory-api.yaml<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    outputDir <span class="z-keyword z-operator z-assignment z-groovy">=</span> layout<span class="z-punctuation z-accessor z-dot z-groovy">.</span>buildDirectory<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">dir</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>generated/openapi<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">get</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span>asFile<span class="z-punctuation z-accessor z-dot z-groovy">.</span>path
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    apiPackage <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>com.example.bookmgmt.api.inventory<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    modelPackage <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>com.example.bookmgmt.model.inventory<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    configOptions <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-structure z-groovy">            <span class="z-constant z-other z-key z-groovy">delegatePattern</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>true<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-structure z-groovy">            <span class="z-constant z-other z-key z-groovy">interfaceOnly</span>  <span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>true<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-structure z-groovy">            <span class="z-constant z-other z-key z-groovy">useSpringBoot3</span> <span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>true<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-structure z-groovy">            <span class="z-constant z-other z-key z-groovy">useTags</span>        <span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>true<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-structure z-groovy">    <span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span><span class="z-source z-groovy">
</span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Make sure the generated sources are included in the source sets
</span></span><span class="z-source z-groovy">sourceSets <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    main <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        java <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            srcDir layout<span class="z-punctuation z-accessor z-dot z-groovy">.</span>buildDirectory<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">dir</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>generated/openapi/src/main/java<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">get</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span>asFile<span class="z-punctuation z-accessor z-dot z-groovy">.</span>path
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span><span class="z-source z-groovy">
</span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Make sure the code is generated before compiling
</span></span><span class="z-source z-groovy">compileJava<span class="z-punctuation z-accessor z-dot z-groovy">.</span>dependsOn tasks<span class="z-punctuation z-accessor z-dot z-groovy">.</span>inventoryApi
</span><span class="z-source z-groovy">compileJava<span class="z-punctuation z-accessor z-dot z-groovy">.</span>dependsOn tasks<span class="z-punctuation z-accessor z-dot z-groovy">.</span>catalogApi
</span></code></pre><ol start=3><li>Run <code>gradle build</code></ol><p>The full source of the initial example is available here – <a href=https://github.com/andts/openapi-multi-spec-build-example/tree/7818c8028647b06877565592f60b1767920895e5 rel=noopener target=_blank>github</a>. It has a bit more code to be a fully functional app.<p>With this configuration, each time we run <code>gradle build</code> the OpenAPI generator tasks will execute, even if the specs didn’t change. Even if nothing has changed at all.<pre class=z-code><code><span class="z-text z-plain">❯ gradle build
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">> Task :catalogApi
</span><span class="z-text z-plain">################################################################################
</span><span class="z-text z-plain"># Thanks for using OpenAPI Generator.                                          #
</span><span class="z-text z-plain"># Please consider donation to help us maintain this project 🙏                 #
</span><span class="z-text z-plain"># https://opencollective.com/openapi_generator/donate                          #
</span><span class="z-text z-plain">################################################################################
</span><span class="z-text z-plain">Successfully generated code to /***/build/generated/openapi
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">> Task :inventoryApi
</span><span class="z-text z-plain">################################################################################
</span><span class="z-text z-plain"># Thanks for using OpenAPI Generator.                                          #
</span><span class="z-text z-plain"># Please consider donation to help us maintain this project 🙏                 #
</span><span class="z-text z-plain"># https://opencollective.com/openapi_generator/donate                          #
</span><span class="z-text z-plain">################################################################################
</span><span class="z-text z-plain">Successfully generated code to /***/build/generated/openapi
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">> Task :compileJava
</span><span class="z-text z-plain">> Task :processResources UP-TO-DATE
</span><span class="z-text z-plain">> Task :classes
</span><span class="z-text z-plain">> Task :resolveMainClassName UP-TO-DATE
</span><span class="z-text z-plain">> Task :bootJar UP-TO-DATE
</span><span class="z-text z-plain">> Task :jar UP-TO-DATE
</span><span class="z-text z-plain">> Task :assemble UP-TO-DATE
</span><span class="z-text z-plain">> Task :compileTestJava NO-SOURCE
</span><span class="z-text z-plain">> Task :processTestResources NO-SOURCE
</span><span class="z-text z-plain">> Task :testClasses UP-TO-DATE
</span><span class="z-text z-plain">> Task :test NO-SOURCE
</span><span class="z-text z-plain">> Task :check UP-TO-DATE
</span><span class="z-text z-plain">> Task :build UP-TO-DATE
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">BUILD SUCCESSFUL in 1s
</span><span class="z-text z-plain">7 actionable tasks: 3 executed, 4 up-to-date
</span></code></pre><p>Let’s try to fix that.<h1 id=the-crutch-crutch>The Crutch 🩼</h1><p>A logical solution that comes to mind is to disable generation of those project files. Unfortunately, all I could find are issues like this one – <a href=https://github.com/OpenAPITools/openapi-generator/issues/20538 rel=noopener target=_blank>[REQ] Option to generate only the models/controllers</a><p>Instead, we will do two things:<ol><li>exclude as much project files as possible from generation, and<li>extract each API into its own folder.</ol><p>Technically, you could only do the second, and it would solve the issue, but I wanted to keep the sources as clean as possible.<h2 id=cleanup-broom>Cleanup 🧹</h2><p>The only working way to remove unnecessary project files happens to be through <code>.openapi-generator-ignore</code>. Put a file like this into the root (or wherever you like):<pre class=z-code><code><span class="z-text z-plain">*
</span><span class="z-text z-plain">**/*
</span><span class="z-text z-plain">!**src/main/java/**/*
</span></code></pre><p>This file excludes from generation all files that are not in the source directory. Exactly what we needed.<p>But there is one issue still, which requires the second step. There are two metadata files added in <code>.openapi-generator</code> folder: <code>FILES</code> and <code>VERSION</code>. They contain a list of all generated files, and version of the generator accordingly. And they are not excluded by the ignore file :(</p><img src=/img/shorts/openapi/meta-files.png><p>So now when several tasks generate sources – each will overwrite those files from the previous.<p>Let’s continue.<h2 id=extraction>Extraction 🪏</h2><p>The only option we have left is to put every API interface into its own folder.<br> We will change the task configuration a bit, and will write some more config to attach the sources to the <code>sourceSets</code>.<br> Significant changes are highlighted.<pre class="language-gradle z-code" data-lang=gradle><code class=language-gradle data-lang=gradle><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Generate server stubs for book catalog API
</span></span><span class="z-source z-groovy">tasks<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">register</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>catalogApi<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-storage z-type z-class z-groovy">GenerateTask</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    generatorName <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>spring<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    inputSpec <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-variable z-other z-interpolated z-groovy">$rootDir</span>/src/main/resources/api/book-catalog-api.yaml<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span><mark><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    outputDir <span class="z-keyword z-operator z-assignment z-groovy">=</span> layout<span class="z-punctuation z-accessor z-dot z-groovy">.</span>buildDirectory<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">dir</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>generated/openapi/<span class="z-variable z-other z-interpolated z-groovy">$name</span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">get</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span>asFile<span class="z-punctuation z-accessor z-dot z-groovy">.</span>path
</span></span></mark><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    apiPackage <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>com.example.bookmgmt.api.catalog<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    modelPackage <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>com.example.bookmgmt.model.catalog<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span><mark><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    ignoreFileOverride <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-variable z-other z-interpolated z-groovy">$rootDir</span>/.openapi-generator-ignore<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></mark><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    configOptions <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-structure z-groovy">            <span class="z-constant z-other z-key z-groovy">delegatePattern</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>true<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-structure z-groovy">            <span class="z-constant z-other z-key z-groovy">interfaceOnly</span>  <span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>true<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-structure z-groovy">            <span class="z-constant z-other z-key z-groovy">useSpringBoot3</span> <span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>true<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-structure z-groovy">            <span class="z-constant z-other z-key z-groovy">useTags</span>        <span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>true<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-structure z-groovy">    <span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span><span class="z-source z-groovy">
</span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span>rest of the code ...
</span></span><span class="z-source z-groovy">
</span><mark><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Disable the default openApiGenerate task as we use our specific tasks
</span></span></mark><mark><span class="z-source z-groovy">tasks<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">named</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>openApiGenerate<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></mark><mark><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    enabled <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-constant z-language z-groovy">false</span>
</span></span></mark><mark><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></mark><mark><span class="z-source z-groovy">
</span></mark><mark><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Configure our specific OpenAPI generator tasks to be dependencies of compileJava
</span></span></mark><mark><span class="z-source z-groovy">tasks<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">withType</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-storage z-type z-class z-groovy">GenerateTask</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span>all <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span> task <span class="z-keyword z-operator z-arrow z-groovy">-></span>
</span></span></mark><mark><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    compileJava<span class="z-punctuation z-accessor z-dot z-groovy">.</span>dependsOn task
</span></span></mark><mark><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    sourceSets<span class="z-punctuation z-accessor z-dot z-groovy">.</span>main<span class="z-punctuation z-accessor z-dot z-groovy">.</span>java<span class="z-punctuation z-accessor z-dot z-groovy">.</span>srcDirs <span class="z-keyword z-operator z-arithmetic z-groovy">+</span><span class="z-keyword z-operator z-assignment z-groovy">=</span>
</span></span></mark><mark><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">        layout<span class="z-punctuation z-accessor z-dot z-groovy">.</span>buildDirectory<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">dir</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>generated/openapi/<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>task<span class="z-punctuation z-accessor z-dot z-groovy">.</span>name<span class="z-punctuation z-section z-embedded z-groovy">}</span></span>/src/main/java<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">get</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span>asFile<span class="z-punctuation z-accessor z-dot z-groovy">.</span>path
</span></span></mark><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span><span class="z-source z-groovy">
</span></code></pre><p>Another benefit of this approach is it’s automated, so you don’t have to add the dependencies for every new generator task by hand.<div class="admonition note"><div class="admonition-icon admonition-icon-note"></div><div class=admonition-content><strong class=admonition-title>NOTE</strong><p>Note we had to disable the default task from the plugin, so it wouldn’t mix with our custom generator tasks. Otherwise the build wouldn’t work.</div></div><h1 id=result>Result</h1><p>This is what we get for the first clean build:<pre class=z-code><code><span class="z-text z-plain">❯ gradle build
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">> Task :catalogApi
</span><span class="z-text z-plain">################################################################################
</span><span class="z-text z-plain"># Thanks for using OpenAPI Generator.                                          #
</span><span class="z-text z-plain"># Please consider donation to help us maintain this project 🙏                 #
</span><span class="z-text z-plain"># https://opencollective.com/openapi_generator/donate                          #
</span><span class="z-text z-plain">################################################################################
</span><span class="z-text z-plain">Successfully generated code to /Users/andts/Personal/openapi-gen-post/build/generated/openapi/catalogApi
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">> Task :inventoryApi
</span><span class="z-text z-plain">################################################################################
</span><span class="z-text z-plain"># Thanks for using OpenAPI Generator.                                          #
</span><span class="z-text z-plain"># Please consider donation to help us maintain this project 🙏                 #
</span><span class="z-text z-plain"># https://opencollective.com/openapi_generator/donate                          #
</span><span class="z-text z-plain">################################################################################
</span><span class="z-text z-plain">Successfully generated code to /Users/andts/Personal/openapi-gen-post/build/generated/openapi/inventoryApi
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">> Task :openApiGenerate SKIPPED
</span><span class="z-text z-plain">> Task :compileJava
</span><span class="z-text z-plain">> Task :processResources
</span><span class="z-text z-plain">> Task :classes
</span><span class="z-text z-plain">> Task :resolveMainClassName
</span><span class="z-text z-plain">> Task :bootJar
</span><span class="z-text z-plain">> Task :jar
</span><span class="z-text z-plain">> Task :assemble
</span><span class="z-text z-plain">> Task :compileTestJava NO-SOURCE
</span><span class="z-text z-plain">> Task :processTestResources NO-SOURCE
</span><span class="z-text z-plain">> Task :testClasses UP-TO-DATE
</span><span class="z-text z-plain">> Task :test NO-SOURCE
</span><span class="z-text z-plain">> Task :check UP-TO-DATE
</span><span class="z-text z-plain">> Task :build
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">BUILD SUCCESSFUL in 1s
</span><span class="z-text z-plain">7 actionable tasks: 7 executed
</span></code></pre><p>And this is the process when only the application code has changed, but not the specs:<pre class=z-code><code><span class="z-text z-plain">❯ gradle build
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">> Task :catalogApi UP-TO-DATE
</span><span class="z-text z-plain">> Task :inventoryApi UP-TO-DATE
</span><span class="z-text z-plain">> Task :openApiGenerate SKIPPED
</span><span class="z-text z-plain">> Task :compileJava
</span><span class="z-text z-plain">> Task :processResources UP-TO-DATE
</span><span class="z-text z-plain">> Task :classes
</span><span class="z-text z-plain">> Task :resolveMainClassName
</span><span class="z-text z-plain">> Task :bootJar
</span><span class="z-text z-plain">> Task :jar
</span><span class="z-text z-plain">> Task :assemble
</span><span class="z-text z-plain">> Task :compileTestJava NO-SOURCE
</span><span class="z-text z-plain">> Task :processTestResources NO-SOURCE
</span><span class="z-text z-plain">> Task :testClasses UP-TO-DATE
</span><span class="z-text z-plain">> Task :test NO-SOURCE
</span><span class="z-text z-plain">> Task :check UP-TO-DATE
</span><span class="z-text z-plain">> Task :build
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">BUILD SUCCESSFUL in 1s
</span><span class="z-text z-plain">7 actionable tasks: 4 executed, 3 up-to-date
</span></code></pre><p>As you can see, Gradle will correctly detect that the generated code is <code>UP-TO-DATE</code> and will skip the tasks.<p>Consider this approach if you encounter similar issues in your projects.<br> This solution is particularly useful if you:<ul><li>build with Gradle<li>several OpenAPI specs<li>you build often</ul><p>The example code is available here: <a href=https://github.com/andts/openapi-multi-spec-build-example rel=noopener target=_blank>github</a>. You can see the changes for the steps of this post in the commit history.</section></article></main><div id=button-container><div id=toc-floating-container><input class=toggle id=toc-toggle type=checkbox><label class=overlay for=toc-toggle></label><label title="Toggle Table of Contents" class=button for=toc-toggle id=toc-button><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M414.82-193.094q-18.044 0-30.497-12.32-12.453-12.319-12.453-30.036t12.453-30.086q12.453-12.37 30.497-12.37h392.767q17.237 0 29.927 12.487 12.69 12.486 12.69 30.203 0 17.716-12.69 29.919t-29.927 12.203H414.82Zm0-244.833q-18.044 0-30.497-12.487Q371.87-462.9 371.87-480.45t12.453-29.92q12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.511 12.69 12.512 12.69 29.845 0 17.716-12.69 30.086-12.69 12.37-29.927 12.37H414.82Zm0-245.167q-18.044 0-30.497-12.32t-12.453-30.037q0-17.716 12.453-30.086 12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.486 12.69 12.487 12.69 30.203 0 17.717-12.69 29.92-12.69 12.203-29.927 12.203H414.82ZM189.379-156.681q-32.652 0-55.878-22.829t-23.226-55.731q0-32.549 23.15-55.647 23.151-23.097 55.95-23.097 32.799 0 55.313 23.484 22.515 23.484 22.515 56.246 0 32.212-22.861 54.893-22.861 22.681-54.963 22.681Zm0-245.167q-32.652 0-55.878-23.134-23.226-23.135-23.226-55.623 0-32.487 23.467-55.517t56.12-23.03q32.102 0 54.721 23.288 22.62 23.288 22.62 55.775 0 32.488-22.861 55.364-22.861 22.877-54.963 22.877Zm-.82-244.833q-32.224 0-55.254-23.288-23.03-23.289-23.03-55.623 0-32.333 23.271-55.364 23.272-23.03 55.495-23.03 32.224 0 55.193 23.288 22.969 23.289 22.969 55.622 0 32.334-23.21 55.364-23.21 23.031-55.434 23.031Z"/></svg></label><div class=toc-content><div class=toc-container><ul><li><a href=https://tsvldb.com/shorts/01-openapi-generator-in-gradle-for-multiple-specs/#problem>Problem</a><li><a href=https://tsvldb.com/shorts/01-openapi-generator-in-gradle-for-multiple-specs/#the-cause>The Cause</a> <ul><li><a href=https://tsvldb.com/shorts/01-openapi-generator-in-gradle-for-multiple-specs/#example>Example</a></ul><li><a href=https://tsvldb.com/shorts/01-openapi-generator-in-gradle-for-multiple-specs/#the-crutch-crutch>The Crutch 🩼</a> <ul><li><a href=https://tsvldb.com/shorts/01-openapi-generator-in-gradle-for-multiple-specs/#cleanup-broom>Cleanup 🧹</a><li><a href=https://tsvldb.com/shorts/01-openapi-generator-in-gradle-for-multiple-specs/#extraction>Extraction 🪏</a></ul><li><a href=https://tsvldb.com/shorts/01-openapi-generator-in-gradle-for-multiple-specs/#result>Result</a></ul></div></div></div><a title="Go to the top of the page" class=no-hover-padding href=# id=top-button> <svg viewbox="0 0 20 20" fill=currentColor><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg> </a></div><span class=hidden id=copy-success> Copied! </span><span class=hidden id=copy-init> Copy code to clipboard </span><script defer src=https://tsvldb.com/js/copyCodeToClipboard.min.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" href=https://tsvldb.com/atom.xml rel=noopener target=_blank> <img alt=feed loading=lazy src=https://tsvldb.com/social_icons/rss.svg title=feed> </a></ul></nav><nav class=nav-navs></nav><div class=credits><small> Powered by <a href=https://www.getzola.org rel=noopener target=_blank>Zola</a> & <a href=https://github.com/welpo/tabi rel=noopener target=_blank>tabi</a> </small></div></section><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><h1 class=visually-hidden id=modalTitle>Search</h1><div id=modal-content><div id=searchBar><div aria-hidden=true class=search-icon><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search… role=combobox spellcheck=false><div class="close-icon interactive-icon" title="Clear search" id=clear-search role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></div></div><div id=results-container><div id=results-info><span id=zero_results> No results</span><span id=one_results> $NUMBER result</span><span id=many_results> $NUMBER results</span><span id=two_results> $NUMBER results</span><span id=few_results> $NUMBER results</span></div><div id=results role=listbox></div></div></div></div></footer>